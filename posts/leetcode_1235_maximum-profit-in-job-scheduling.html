
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://tofucode.com/theme/stylesheet/style.min.css">


    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="https://tofucode.com/theme/pygments/monokai.min.css">

    <script src="https://tofucode.com/theme/tipuesearch/jquery.min.js"></script>
    <script src="https://tofucode.com/theme/tipuesearch/tipuesearch.min.js"></script>
    <script src="https://tofucode.com/theme/tipuesearch/tipuesearch.min.js"></script>
    <script src="https://tofucode.com/theme/tipuesearch/tipuesearch_set.min.js"></script>
    <script src="https://tofucode.com/tipuesearch_content.js"></script>
    <link rel="stylesheet" href="https://tofucode.com/theme/tipuesearch/tipuesearch.min.css" />

  <link rel="stylesheet" type="text/css" href="https://tofucode.com/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://tofucode.com/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://tofucode.com/theme/font-awesome/css/solid.css">


    <link href="https://tofucode.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="TofuCode Atom">



<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'G-DCBDZPQQD1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->  


<meta name="author" content="Zeph" />
<meta name="description" content="Question Link : https://leetcode.com/problems/maximum-profit-in-job-scheduling/ Difficulty: Hard Premium: False Question We have n jobs, where every job is scheduled to be done from startTime[i] to endTime[i], obtaining a profit of profit[i]. You&#39;re given the startTime, endTime and profit arrays, return the maximum profit you can …" />
<meta name="keywords" content="dp, priority-queue">


<meta property="og:site_name" content="TofuCode"/>
<meta property="og:title" content="Leetcode 1235. Maximum Profit in Job Scheduling"/>
<meta property="og:description" content="Question Link : https://leetcode.com/problems/maximum-profit-in-job-scheduling/ Difficulty: Hard Premium: False Question We have n jobs, where every job is scheduled to be done from startTime[i] to endTime[i], obtaining a profit of profit[i]. You&#39;re given the startTime, endTime and profit arrays, return the maximum profit you can …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://tofucode.com/posts/leetcode_1235_maximum-profit-in-job-scheduling.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2025-02-06 00:00:00-08:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://tofucode.com/author/zeph.html">
<meta property="article:section" content="Leetcode"/>
<meta property="article:tag" content="dp"/>
<meta property="article:tag" content="priority-queue"/>
<meta property="og:image" content="">

  <title>TofuCode &ndash; Leetcode 1235. Maximum Profit in Job Scheduling</title>

</head>
<body class="light-theme">
  <aside>
    <div>
      <a href="https://tofucode.com">
        <img src="https://tofucode.com/theme/img/profile.png" alt="TofuCode" title="TofuCode">
      </a>

      <h1>
        <a href="https://tofucode.com">TofuCode</a>
      </h1>

      
      <ul class="list social">
      </ul>

        <form class="navbar-search" action="/search.html" role="search">
          <input type="text" name="q" id="tipue_search_input" placeholder="Search...">
        </form>

      <nav>
        <ul class="list">



            <li>
              <a target="_self" href="/pages/interview-questions.html" >Interview Questions</a>
            </li>
            <li>
              <a target="_self" href="/category/leetcode.html" >Recent Questions</a>
            </li>
            <li>
              <a target="_self" href="/tags.html" >Tags</a>
            </li>
        </ul>
      </nav>

    </div>

  </aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="leetcode_1235_maximum-profit-in-job-scheduling">Leetcode 1235. Maximum Profit in Job Scheduling</h1>
    <p>
      Posted on Thu 06 February 2025 in <a href="https://tofucode.com/category/leetcode.html">Leetcode</a>

    </p>
  </header>


  <div>
    <p>Question Link : <a href="https://leetcode.com/problems/maximum-profit-in-job-scheduling/">https://leetcode.com/problems/maximum-profit-in-job-scheduling/</a></p>
<p>Difficulty: Hard</p>
<p>Premium: False</p>
<h3>Question</h3>
<p>We have n jobs, where every job is scheduled to be done from startTime[i] to endTime[i], obtaining a profit of profit[i].
You're given the startTime, endTime and profit arrays, return the maximum profit you can take such that there are no two jobs in the subset with overlapping time range.
If you choose a job that ends at time X you will be able to start another job that starts at time X.
 
Example 1:</p>
<p>Input: startTime = [1,2,3,3], endTime = [3,4,5,6], profit = [50,10,40,70]
Output: 120
Explanation: The subset chosen is the first and fourth job. 
Time range [1-3]+[3-6] , we get profit of 120 = 50 + 70.</p>
<p>Example 2:</p>
<p>Input: startTime = [1,2,3,4,6], endTime = [3,5,10,6,9], profit = [20,20,100,70,60]
Output: 150
Explanation: The subset chosen is the first, fourth and fifth job. 
Profit obtained 150 = 20 + 70 + 60.</p>
<p>Example 3:</p>
<p>Input: startTime = [1,1,1], endTime = [2,3,4], profit = [5,6,4]
Output: 6</p>
<p>Constraints:</p>
<p>1 &lt;= startTime.length == endTime.length == profit.length &lt;= 5 * 104
1 &lt;= startTime[i] &lt; endTime[i] &lt;= 109
1 &lt;= profit[i] &lt;= 104</p>
<h3>Solution</h3>
<p>The easiest approach is to use dp and think about the problem of to do the current task for the current profit or not. Another way to do this is to use a priority queue and merge the possible intervals.</p>
<h3>Code</h3>
<div class="highlight"><pre><span></span><code><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Leetcode 1235. Maximum Profit in Job Scheduling</span>
<span class="sd">Question Link : https://leetcode.com/problems/maximum-profit-in-job-scheduling/</span>
<span class="sd">Solution Link : https://tofucode.com/posts/leetcode_1235_maximum-profit-in-job-scheduling.html</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">jobScheduling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startTime</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">endTime</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">profit</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        dp[i] = maxprofit up to job i</span>
<span class="sd">            dp[i+1] = max(dp[i], last possible place + job i profit)</span>
<span class="sd">            return dp[n]</span>
<span class="sd">        sort by end time</span>
<span class="sd">            so based on job i start, find idx of last possible endTime</span>

<span class="sd">        Time : O(n log n)</span>
<span class="sd">        Space: O(n)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Sort jobs by end time</span>
        <span class="n">jobs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">startTime</span><span class="p">,</span> <span class="n">endTime</span><span class="p">,</span> <span class="n">profit</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">endTimes</span> <span class="o">=</span> <span class="p">[</span><span class="n">job</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">]</span>

        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">jobs</span><span class="p">)</span>
        <span class="n">dp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">curStart</span><span class="p">,</span> <span class="n">curEnd</span><span class="p">,</span> <span class="n">curProfit</span> <span class="o">=</span> <span class="n">jobs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_right</span><span class="p">(</span><span class="n">endTimes</span><span class="p">,</span> <span class="n">curStart</span><span class="p">)</span>

            <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">curProfit</span> <span class="o">+</span> <span class="n">dp</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">dp</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>

<span class="kn">from</span> <span class="nn">queue</span> <span class="kn">import</span> <span class="n">PriorityQueue</span>

<span class="k">class</span> <span class="nc">SolutionAlternative1</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">jobScheduling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startTime</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">endTime</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">profit</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Input: startTime = [1,2,3,4,6], endTime = [3,5,10,6,9], profit = [20,20,100,70,60]</span>

<span class="sd">        1   2   3   4   5   6   7   8   9   10</span>
<span class="sd">        [20     ]</span>
<span class="sd">        maxProfit: 0</span>

<span class="sd">        [20     ]</span>
<span class="sd">            [20         ]</span>
<span class="sd">        maxProfit: 0</span>

<span class="sd">            [20         ]</span>
<span class="sd">        [20     ][100                          ] = 120</span>
<span class="sd">        maxProfit: 20</span>

<span class="sd">            [20         ]</span>
<span class="sd">        [120                                 ]</span>
<span class="sd">        [20     ]   [70     ]                    = 90</span>
<span class="sd">        maxProfit: 20</span>


<span class="sd">            [20         ] remove</span>
<span class="sd">        [120                                 ]</span>
<span class="sd">        [20     ]   [70     ][60       ]          = 150</span>
<span class="sd">        maxProfit: 90</span>


<span class="sd">        Track maxProfit: max profit up to current job</span>
<span class="sd">        for each job:</span>
<span class="sd">            check if can make a longer chain with all previous chains</span>
<span class="sd">                want ealiest end time (priority queue sorted on end time )</span>
<span class="sd">                can remove them</span>

<span class="sd">        process rest of the p queue</span>

<span class="sd">        Time : O(n log n)</span>
<span class="sd">        Space: O(n)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">jobs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">startTime</span><span class="p">,</span> <span class="n">endTime</span><span class="p">,</span> <span class="n">profit</span><span class="p">))</span>

        <span class="n">max_profit</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">pq</span> <span class="o">=</span> <span class="n">PriorityQueue</span><span class="p">()</span>  <span class="c1"># (endTime, accumulatedProfit)</span>

        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">profit</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">:</span>
            <span class="c1"># Remove jobs that end before the current job</span>
            <span class="k">while</span> <span class="ow">not</span> <span class="n">pq</span><span class="o">.</span><span class="n">empty</span><span class="p">()</span> <span class="ow">and</span> <span class="n">pq</span><span class="o">.</span><span class="n">queue</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">start</span><span class="p">:</span>
                    <span class="n">max_profit</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_profit</span><span class="p">,</span> <span class="n">pq</span><span class="o">.</span><span class="n">get</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>

            <span class="c1"># Push current job with profit added to the best available profit</span>
            <span class="n">pq</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">end</span><span class="p">,</span> <span class="n">max_profit</span> <span class="o">+</span> <span class="n">profit</span><span class="p">))</span>

        <span class="k">while</span> <span class="ow">not</span> <span class="n">pq</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
            <span class="n">max_profit</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_profit</span><span class="p">,</span> <span class="n">pq</span><span class="o">.</span><span class="n">get</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">max_profit</span>
</code></pre></div>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://tofucode.com/tag/dp.html">dp</a>
      <a href="https://tofucode.com/tag/priority-queue.html">priority-queue</a>
    </p>
  </div>





</article>

    <footer>
<p> Eat Tofu and be true </p>
<p>&copy; 2025 TofuCode.com</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " TofuCode ",
  "url" : "https://tofucode.com",
  "image": "",
  "description": ""
}
</script>

    <script>
      $(document).ready(function() {
        $('#tipue_search_input').tipuesearch();
      });
    </script>

</body>
</html>