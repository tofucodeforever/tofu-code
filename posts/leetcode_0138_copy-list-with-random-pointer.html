
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://tofucode.com/theme/stylesheet/style.min.css">


    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="https://tofucode.com/theme/pygments/monokai.min.css">

    <script src="https://tofucode.com/theme/tipuesearch/jquery.min.js"></script>
    <script src="https://tofucode.com/theme/tipuesearch/tipuesearch.min.js"></script>
    <script src="https://tofucode.com/theme/tipuesearch/tipuesearch.min.js"></script>
    <script src="https://tofucode.com/theme/tipuesearch/tipuesearch_set.min.js"></script>
    <script src="https://tofucode.com/tipuesearch_content.js"></script>
    <link rel="stylesheet" href="https://tofucode.com/theme/tipuesearch/tipuesearch.min.css" />

  <link rel="stylesheet" type="text/css" href="https://tofucode.com/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://tofucode.com/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://tofucode.com/theme/font-awesome/css/solid.css">


    <link href="https://tofucode.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="TofuCode Atom">



<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'G-DCBDZPQQD1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->  


<meta name="author" content="Zeph" />
<meta name="description" content="Question Link : https://leetcode.com/problems/copy-list-with-random-pointer/ Difficulty: Medium Question A linked list of length n is given such that each node contains an additional random pointer, which could point to any node in the list, or null. Construct a deep copy of the list. The deep copy should consist …" />
<meta name="keywords" content="linked-list, dummy-list-head, recursion">


<meta property="og:site_name" content="TofuCode"/>
<meta property="og:title" content="Leetcode 0138. Copy List with Random Pointer"/>
<meta property="og:description" content="Question Link : https://leetcode.com/problems/copy-list-with-random-pointer/ Difficulty: Medium Question A linked list of length n is given such that each node contains an additional random pointer, which could point to any node in the list, or null. Construct a deep copy of the list. The deep copy should consist …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://tofucode.com/posts/leetcode_0138_copy-list-with-random-pointer.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2022-03-11 00:00:00-08:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://tofucode.com/author/zeph.html">
<meta property="article:section" content="Leetcode"/>
<meta property="article:tag" content="linked-list"/>
<meta property="article:tag" content="dummy-list-head"/>
<meta property="article:tag" content="recursion"/>
<meta property="og:image" content="">

  <title>TofuCode &ndash; Leetcode 0138. Copy List with Random Pointer</title>

</head>
<body class="light-theme">
  <aside>
    <div>
      <a href="https://tofucode.com">
        <img src="https://tofucode.com/theme/img/profile.png" alt="TofuCode" title="TofuCode">
      </a>

      <h1>
        <a href="https://tofucode.com">TofuCode</a>
      </h1>

      
      <ul class="list social">
      </ul>

        <form class="navbar-search" action="/search.html" role="search">
          <input type="text" name="q" id="tipue_search_input" placeholder="Search...">
        </form>

      <nav>
        <ul class="list">



            <li>
              <a target="_self" href="/pages/interview-questions.html" >Interview Questions</a>
            </li>
            <li>
              <a target="_self" href="/category/leetcode.html" >Recent Questions</a>
            </li>
            <li>
              <a target="_self" href="/tags.html" >Tags</a>
            </li>
        </ul>
      </nav>

    </div>

  </aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="leetcode_0138_copy-list-with-random-pointer">Leetcode 0138. Copy List with Random Pointer</h1>
    <p>
      Posted on Fri 11 March 2022 in <a href="https://tofucode.com/category/leetcode.html">Leetcode</a>

    </p>
  </header>


  <div>
    <p>Question Link : <a href="https://leetcode.com/problems/copy-list-with-random-pointer/">https://leetcode.com/problems/copy-list-with-random-pointer/</a></p>
<p>Difficulty: Medium</p>
<h3>Question</h3>
<p>A linked list of length n is given such that each node contains an additional random pointer, which could point to any node in the list, or null.
Construct a deep copy of the list. The deep copy should consist of exactly n brand new nodes, where each new node has its value set to the value of its corresponding original node. Both the next and random pointer of the new nodes should point to new nodes in the copied list such that the pointers in the original list and copied list represent the same list state. None of the pointers in the new list should point to nodes in the original list.
For example, if there are two nodes X and Y in the original list, where X.random --&gt; Y, then for the corresponding two nodes x and y in the copied list, x.random --&gt; y.
Return the head of the copied linked list.
The linked list is represented in the input/output as a list of n nodes. Each node is represented as a pair of [val, random_index] where:</p>
<p>val: an integer representing Node.val
random_index: the index of the node (range from 0 to n-1) that the random pointer points to, or null if it does not point to any node.</p>
<p>Your code will only be given the head of the original linked list.
 
Example 1:</p>
<p>Input: head = [[7,null],[13,0],[11,4],[10,2],[1,0]]
Output: [[7,null],[13,0],[11,4],[10,2],[1,0]]</p>
<p>Example 2:</p>
<p>Input: head = [[1,1],[2,1]]
Output: [[1,1],[2,1]]</p>
<p>Example 3:</p>
<p>Input: head = [[3,null],[3,0],[3,null]]
Output: [[3,null],[3,0],[3,null]]</p>
<p>Constraints:</p>
<p>0 &lt;= n &lt;= 1000
-104 &lt;= Node.val &lt;= 104
Node.random is null or is pointing to some node in the linked list.</p>
<h3>Solution</h3>
<ul>
<li>This is essentially a list iteration with a bit of extra work to deal with the random pointers with a hashmap </li>
<li>Alternatively recursive solution can also be very clean </li>
</ul>
<h3>Code</h3>
<div class="highlight"><pre><span></span><code><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Leetcode 0138. Copy List with Random Pointer</span>
<span class="sd">Question Link : https://leetcode.com/problems/copy-list-with-random-pointer/</span>
<span class="sd">Solution Link : https://tofucode.com/posts/leetcode_0138_copy-list-with-random-pointer.html</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd"># Definition for a Node.</span>
<span class="sd">class Node:</span>
<span class="sd">    def __init__(self, x: int, next: &#39;Node&#39; = None, random: &#39;Node&#39; = None):</span>
<span class="sd">        self.val = int(x)</span>
<span class="sd">        self.next = next</span>
<span class="sd">        self.random = random</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">copyRandomList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">head</span><span class="p">:</span> <span class="s1">&#39;Optional[Node]&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Optional[Node]&#39;</span><span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        list iteration with a hashmap old pointers -&gt; new node</span>

<span class="sd">        Time : O(n)</span>
<span class="sd">        space: O(n)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">pointers</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># old pointers -&gt; new node</span>
        <span class="n">dummy</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">head</span>
        <span class="n">new_p</span> <span class="o">=</span> <span class="n">dummy</span>

        <span class="k">while</span> <span class="n">p</span><span class="p">:</span>
            <span class="c1"># get or create new node</span>
            <span class="n">pointers</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">pointers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Node</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">val</span><span class="p">))</span>

            <span class="c1"># if there is random: get or create random</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">random</span>
            <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
                <span class="n">pointers</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="n">pointers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">r</span><span class="p">,</span>  <span class="n">Node</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">val</span><span class="p">))</span>
                <span class="n">pointers</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">random</span> <span class="o">=</span> <span class="n">pointers</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="c1"># set up the new random node</span>

            <span class="c1"># move both pointers</span>
            <span class="n">new_p</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="n">pointers</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>
            <span class="n">new_p</span> <span class="o">=</span> <span class="n">new_p</span><span class="o">.</span><span class="n">next</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">next</span>

        <span class="k">return</span> <span class="n">dummy</span><span class="o">.</span><span class="n">next</span>

<span class="k">class</span> <span class="nc">SolutionAlternative1</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">copyRandomList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">head</span><span class="p">:</span> <span class="s1">&#39;Optional[Node]&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Optional[Node]&#39;</span><span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        list iteration with a hashmap old pointers -&gt; new node</span>

<span class="sd">        Time : O(n)</span>
<span class="sd">        space: O(n)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pointers</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># old pointer -&gt; new node</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copyRandom</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">copyRandom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">head</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">head</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">head</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pointers</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pointers</span><span class="p">[</span><span class="n">head</span><span class="p">]</span>

        <span class="c1"># create a new node.</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">head</span><span class="o">.</span><span class="n">val</span><span class="p">)</span>

        <span class="c1"># save in hashmap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pointers</span><span class="p">[</span><span class="n">head</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>

        <span class="c1"># keep going to next and random via recursion</span>
        <span class="n">node</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copyRandom</span><span class="p">(</span><span class="n">head</span><span class="o">.</span><span class="n">next</span><span class="p">)</span>
        <span class="n">node</span><span class="o">.</span><span class="n">random</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copyRandom</span><span class="p">(</span><span class="n">head</span><span class="o">.</span><span class="n">random</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">node</span>
</code></pre></div>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://tofucode.com/tag/linked-list.html">linked-list</a>
      <a href="https://tofucode.com/tag/dummy-list-head.html">dummy-list-head</a>
      <a href="https://tofucode.com/tag/recursion.html">recursion</a>
    </p>
  </div>





</article>

    <footer>
<p> Eat Tofu and be true </p>
<p>&copy; 2023 TofuCode.com</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " TofuCode ",
  "url" : "https://tofucode.com",
  "image": "",
  "description": ""
}
</script>

    <script>
      $(document).ready(function() {
        $('#tipue_search_input').tipuesearch();
      });
    </script>

</body>
</html>